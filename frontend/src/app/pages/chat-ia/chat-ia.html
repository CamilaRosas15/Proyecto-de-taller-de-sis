<div class="app-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">
      <img src="assets/logo.png" alt="Logo" class="logo-img">
      <h2>Nutrichef IA</h2>
    </div>

    <nav class="menu">
      <button class="menu-btn" routerLink="/principal">ğŸ  Inicio</button>
      <button class="menu-btn" routerLink="/recetas">ğŸ“– Recetas</button>
      <button class="menu-btn active">ğŸ’¬ Chat con IA</button>
      <button class="menu-btn" routerLink="/analisis-imagen">ğŸ“¸ Analizar Imagen</button>
      
      <div class="historial">
        <h4>Historial de Recetas</h4>
        <button class="historial-btn">Smoothie EnergÃ©tico</button>
        <button class="historial-btn">Wrap de Pollo</button>
        <button class="historial-btn">Ensalada CÃ©sar</button>
      </div>
    </nav>

    <div class="user-info">
      <img src="assets/user.png" alt="Usuario" class="avatar">
      <div>
        <p class="username">Username</p>
        <p class="user-handle">@Username</p>
      </div>
    </div>
  </aside>

  <!-- Main content -->
  <main class="main-content">
    <!-- Header -->
    <header class="header">
      <h1>ğŸ’¬ Â¿QuÃ© te gustarÃ­a cocinar?</h1>
      <button class="progress-btn">â°</button>
    </header>

    <!-- Chat Container -->
    <div class="chat-container">
      <!-- Mensaje inicial del bot -->
      <div class="message bot-message">
        <div class="message-avatar">ğŸ¤–</div>
        <div class="message-content">
          <div class="message-text">
            Â¡Hola! Soy NutriChef IA. CuÃ©ntame tus preferencias y te recomendarÃ© recetas personalizadas. 
            Puedes contarme sobre tus gustos, alergias, tiempo disponible y objetivo calÃ³rico.
          </div>
          <div class="message-time">Ahora</div>
        </div>
      </div>

      <!-- Input del usuario -->
      <div class="user-input-section">
        <div class="input-container">
          <input 
            type="text" 
            [(ngModel)]="userMessage" 
            placeholder="Pregunta lo que quieras..."
            (keyup.enter)="sendMessage()"
            class="message-input">
          <button (click)="sendMessage()" class="send-btn">â¤</button>
        </div>
        
        <!-- Botones rÃ¡pidos -->
        <div class="quick-buttons">
          <button class="quick-btn" (click)="quickAction('recomendacion')">
            ğŸ½ï¸ Dame una recomendaciÃ³n
          </button>
          <button class="quick-btn" (click)="quickAction('rapida')">
            â±ï¸ Receta rÃ¡pida
          </button>
          <button class="quick-btn" (click)="quickAction('saludable')">
            ğŸ¥— Algo saludable
          </button>
        </div>
      </div>

      <!-- Mensajes del chat -->
      <div class="messages-container">
        <!-- Mensaje del usuario -->
        <div *ngIf="userMessage" class="message user-message">
          <div class="message-content">
            <div class="message-text">{{ userMessage }}</div>
            <div class="message-time">Ahora</div>
          </div>
          <div class="message-avatar">ğŸ‘¤</div>
        </div>

        <!-- Respuesta de la IA con recetas -->
        <div *ngIf="opcionesRecetas.length > 0" class="recipes-response">
          <div class="message bot-message">
            <div class="message-avatar">ğŸ¤–</div>
            <div class="message-content">
              <div class="message-text">
                Â¡Perfecto! BasÃ¡ndome en tus preferencias, te recomiendo estas opciones:
              </div>
              <div class="message-time">Ahora</div>
            </div>
          </div>

          <!-- Cards de recetas -->
          <div *ngFor="let receta of opcionesRecetas" class="recipe-card">
            <div class="recipe-header">
              <h3>{{ receta.titulo }}</h3>
              <div class="recipe-meta">
                <span class="meta-item">â±ï¸ {{ receta.tiempo_preparacion }} min</span>
                <span class="meta-item">ğŸ”¥ {{ receta.kcal_totales }} kcal</span>
                <span class="meta-item">ğŸ“ {{ receta.categoria }}</span>
              </div>
            </div>

            <p class="recipe-description">{{ receta.descripcion }}</p>

            <!-- ExplicaciÃ³n de la IA -->
            <div *ngIf="receta.ia_explicacion" class="ia-explanation">
              <div class="explanation-header">
                <strong>ğŸ’¡ Por quÃ© te recomiendo esta receta:</strong>
              </div>
              <div class="explanation-content">
                {{ receta.ia_explicacion }}
              </div>
            </div>

            <!-- Ingredientes -->
            <div class="ingredients-section">
              <h4>ğŸ›’ Ingredientes:</h4>
              <div class="ingredients-grid">
                <span *ngFor="let ing of receta.ingredientes" class="ingredient-tag">
                  {{ ing.nombre }}
                  <span *ngIf="ing.cantidad" class="quantity">
                    ({{ ing.cantidad }} {{ ing.unidad || 'un' }})
                  </span>
                </span>
              </div>
            </div>

            <!-- Pasos de preparaciÃ³n -->
            <div class="steps-section">
              <h4>ğŸ‘©â€ğŸ³ PreparaciÃ³n:</h4>
              <ol class="steps-list">
                <li *ngFor="let paso of receta.pasos; let i = index" class="step-item">
                  {{ paso }}
                </li>
              </ol>
            </div>
          </div>
        </div>

        <!-- Loading -->
        <div *ngIf="cargando" class="message bot-message">
          <div class="message-avatar">ğŸ¤–</div>
          <div class="message-content">
            <div class="message-text">
              <div class="typing-indicator">
                <span></span>
                <span></span>
                <span></span>
              </div>
              Analizando tus preferencias y buscando las mejores recetas para ti...
            </div>
          </div>
        </div>

        <!-- Error -->
        <div *ngIf="errorMessage" class="message bot-message error">
          <div class="message-avatar">ğŸ¤–</div>
          <div class="message-content">
            <div class="message-text">
              âŒ {{ errorMessage }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>